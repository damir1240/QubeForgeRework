# Дизайн-документ: Моб "Дикий кабан" (Wild Boar)

## 1. Визуальный концепт

**Общее описание:**
Массивное четвероногое животное, выполненное в кубическом стиле. Силуэт приземистый, с крупной головой и выраженными клыками.

**Модель (Геометрия):**
Модель состоит из примитивов (BoxGeometry), объединенных в иерархию для анимации. Размеры адаптированы под систему блоков (1 блок = 1 метр).
*   **Туловище (Body):** Прямоугольное, плотное. Примерно 0.9 (длина) x 0.5 (высота) x 0.5 (ширина).
*   **Голова (Head):** Крупная, прикреплена спереди туловища.
*   **Пятак (Snout):** Небольшой выступ на лицевой части головы.
*   **Клыки (Tusks):** Два белых пиксельных элемента, выступающих вверх из нижней части морды.
*   **Ноги (Legs):** 4 короткие ноги, расположенные по углам туловища.

**Цветовая гамма:**
*   **Основной цвет (Шерсть):** Темно-коричневый (#4A3728) или серо-бурый. Используется текстура шума (noise texture) из `World`, подкрашенная цветом.
*   **Пятак:** Розоватый (#E6B8B7).
*   **Клыки:** Белые (#FFFFFF).
*   **Копыта:** Темно-серые (#2F2F2F).

## 2. Логика поведения (AI)

Моб классифицируется как **Пассивный** (Passive), но с механикой избегания угроз.

### Idle (Покой)
*   **Блуждание (Wander):** Случайное перемещение на небольшие расстояния.
*   **Кормление (Eat Animation):** Периодически останавливается и опускает голову к земле (анимация рытья/еды). Это чисто визуальное состояние, не изменяющее блоки.
*   **Бездействие:** Просто стоит на месте, озираясь.

### Alert (Тревога) — *Новое состояние*
*   **Триггер:** Игрок приближается на расстояние < 8 блоков.
*   **Поведение:** Кабан прекращает текущее действие (еду/блуждание), поворачивается головой к игроку и замирает на 1-2 секунды.
*   **Переход:**
    *   Если игрок подходит ближе (< 4 блока) -> переход в **Flee**.
    *   Если игрок атакует -> переход в **Flee**.
    *   Если игрок уходит -> возврат в **Idle**.

### Flee (Бегство) — *Новое состояние*
*   **Триггер:** Получение урона или нарушение личной дистанции (Alert перерастает в панику).
*   **Поведение:** Моб выбирает вектор, противоположный положению игрока, и бежит с повышенной скоростью.
*   **Длительность:** Бежит в течение 3-5 секунд или пока расстояние до игрока не станет > 15 блоков.
*   **Хаотичность:** Вектор движения может иметь небольшое случайное отклонение, чтобы поведение выглядело более "животным".

## 3. Технические характеристики

| Параметр | Значение | Комментарий |
| :--- | :--- | :--- |
| **HP (Здоровье)** | 10 | Меньше, чем у Зомби (20), убивается с 2-3 ударов рукой. |
| **Walk Speed** | 1.5 | Медленное, спокойное перемещение. |
| **Run Speed** | 4.5 | Быстрее скорости ходьбы игрока (Player walk ~4.3), трудно догнать без спринта. |
| **Detection Radius** | 8 блоков | Дистанция начала тревоги. |
| **Hitbox** | 0.9 x 0.9 | Ширина x Высота (примерно 1 блок в высоту). |

## 4. Список анимаций (Процедурные)

Анимации реализуются через изменение вращения (rotation) групп мешей в методе `updateAI` или `updateAnimation`.

1.  **Idle:**
    *   Легкое "дыхание" (масштабирование грудной клетки или покачивание головы по Y).
2.  **Walk:**
    *   Стандартная походка четвероногих: противофазное движение диагональных пар ног (Левая Передняя + Правая Задняя движутся вместе).
3.  **Run (Flee):**
    *   Увеличенная частота движения ног.
    *   Тело слегка наклоняется вперед (pitch).
    *   Голова приподнята.
4.  **Eat:**
    *   Остановка движения.
    *   Наклон головы вниз (rotation.x).
    *   Быстрое покачивание головой.
5.  **Get Hit:**
    *   Стандартный красный флэш (уже реализован в `Mob.ts`).
    *   Отбрасывание (Knockback).
6.  **Die:**
    *   Моб падает на бок (поворот всего объекта на 90 градусов) и исчезает с партиклами (дым).

## 5. Лут (Loot)

При смерти (`isDead = true`) спавнится `ItemEntity`.

*   **Основной дроп:** Сырое мясо (Raw Meat / Porkchop).
    *   ID предмета: (Нужно будет добавить новый ID или использовать существующий плейсхолдер).
    *   Количество: 1-3 шт.
*   **Редкий дроп:** Кожа (Leather).
    *   Шанс: 20%.

---
**План реализации:**
1.  Создать класс `WildBoar` наследуемый от `Mob`.
2.  Смоделировать геометрию в конструкторе (Body, Head, Legs, Tusks).
3.  Расширить `MobState` в `Mob.ts` (добавить `FLEE`).
4.  Реализовать логику `Flee` и `Alert` в `WildBoar.ts`.
5.  Зарегистрировать спавн кабана в `MobManager.ts` (днем, на траве).